adjust the position to load the filterfunction
make sure registration is ok , than make sure the inner logic is ok
1 modify the underlying structure of es into thread safety
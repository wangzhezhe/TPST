#!/bin/sh
#SBATCH -J ED_SERVER
#SBATCH -o ED_SERVER.%J.stdout
#SBATCH -e ED_SERVER.%J.stderr
#SBATCH -N 1
#SBATCH -p short
#SBATCH --qos short-award
#SBATCH -t 00:03:00

module load openmpi
module load python/3.6.3


cd ~/pythonWorkSpace/nbodysimulation/

source ./bin/activate

sleep 1
source /home1/zw241/.grpc

module load python/3.6.3

DIR=.

# start the notify server, register the sub

ITR=10

cd /project1/parashar-001/zw241/software/eventDrivenWorkflow/tests/exp_totalruntime/PatternEvent

# start the sim

python sim.py $ITR 1  >& $DIR/event_sim.log  &

# start the check, when there is interesting thing, publish event

python check.py $ITR >& $DIR/event_check.log  &

wait